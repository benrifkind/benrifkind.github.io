<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<title>Analysis of Bicep Curl Quality &#8211; This is a website</title>
<meta name="description" content="For my first post I thought I’d write about some basic data classification. I’ve been going through the courses given by Carnegie Melon in the Data Science Specialization Stream to learn R and some 
introductory data science techniques. I recommend it. 

">
<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Analysis of Bicep Curl Quality">
<meta name="twitter:description" content="For my first post I thought I’d write about some basic data classification. I’ve been going through the courses given by Carnegie Melon in the Data Science Specialization Stream to learn R and some 
introductory data science techniques. I recommend it. 

">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Analysis of Bicep Curl Quality">
<meta property="og:description" content="For my first post I thought I’d write about some basic data classification. I’ve been going through the courses given by Carnegie Melon in the Data Science Specialization Stream to learn R and some 
introductory data science techniques. I recommend it. 

">
<meta property="og:url" content="http://localhost:4000/Analysis-of-Bicep-Curl-Quality/">
<meta property="og:site_name" content="This is a website">





<link rel="canonical" href="http://localhost:4000/Analysis-of-Bicep-Curl-Quality/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="This is a website Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">This is a website</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					        
					    
					    <li><a href="http://localhost:4000/about/" >About</a></li>
					  
					    
					        
					    
					    <li><a href="http://localhost:4000/posts/" >Posts</a></li>
					  
					    
					        
					    
					    <li><a href="http://localhost:4000/research/" >Research</a></li>
					  
					    
					        
					    
					    <li><a href="http://localhost:4000/downloads/BenRifkindCV.pdf" >CV</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    



	<img src="http://localhost:4000/images/BenR2.jpg" class="bio-photo" alt="Ben Rifkind bio photo">

<h3>Ben Rifkind</h3>
<p>I recently completed my Ph.D in probability at the University of Toronto. Now I am messing around with R, python, and statistical analysis.</p>







<a href="http://github.com/benrifkind" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>








  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://localhost:4000/Analysis-of-Bicep-Curl-Quality/" rel="bookmark" title="Analysis of Bicep Curl Quality">Analysis of Bicep Curl Quality</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>For my first post I thought I’d write about some basic data classification. I’ve been going through the courses given by Carnegie Melon in the <a href="https://www.coursera.org/specialization/jhudatascience/1">Data Science Specialization Stream</a> to learn R and some 
introductory data science techniques. I recommend it. </p>

<p>Anyway, for the <a href="https://class.coursera.org/predmachlearn-006">Practical Machine Learning Course</a> they asked us to classify the how well people were performing bicep curls. The data as well as the explanation of the problem is <a href="http://groupware.les.inf.puc-rio.br/har">here</a>. We have data taken from subjects wearing sensors while they perform a bicep curl with five differing techniques (“A”, “B”, “C”, “D”, “E”). “A” corresponds to a “proper” bicep curl and the rest are differing bad techniques. The goal is to use this data to construct a classifier that can then predict the type of bicep curl using only the sensory data.   </p>

<p>The <a href="http://cran.r-project.org/web/packages/randomForest/index.html">random forest</a> worked extremely well for this. </p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>randomForest<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>caret<span class="p">)</span></code></pre></div>

<p>Read in the training data</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">train <span class="o">=</span> read.csv<span class="p">(</span><span class="s">&quot;pml-training.csv&quot;</span><span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span></code></pre></div>

<p>There were a lot of columns which had many NA values and/or just missing data. I wrote a function to find the indices of these ‘useless’ columns. From inspecting the columns it seemed appropriate to remove those which did not have more than 406 entries which are not blank or NA.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#function to find index of columns with very little usable data</span>
<span class="c1">#from training data (blanks and NA&#39;s)</span>
bad.cols <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>dataframe<span class="p">,</span> threshold <span class="o">=</span> <span class="m">406</span><span class="p">){</span>
  
  <span class="c1">#count how many non NA&#39;s are in a column</span>
  count.non.nas <span class="o">=</span>  <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
    <span class="kp">sum</span><span class="p">(</span><span class="o">!</span><span class="kp">is.na</span><span class="p">(</span>x<span class="p">))</span> 
  <span class="p">}</span>
  <span class="c1">#find columns with too many na&#39;s</span>
  na.cols <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>dataframe<span class="p">,</span> MARGIN <span class="o">=</span> <span class="m">2</span><span class="p">,</span> count.non.nas<span class="p">)</span> <span class="o">&gt;</span> threshold
  na.cols <span class="o">=</span> <span class="kp">which</span><span class="p">(</span>na.cols <span class="o">==</span> <span class="bp">F</span><span class="p">)</span>
  
  <span class="c1">#count how many columns do not have blanks</span>
  count.non.blanks <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
    <span class="kp">sum</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="kp">nchar</span><span class="p">(</span>x<span class="p">)</span> <span class="o">==</span> <span class="m">0</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="c1">#remove columns with too many blanks</span>
  blank.cols <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>dataframe<span class="p">,</span> MARGIN <span class="o">=</span> <span class="m">2</span><span class="p">,</span> count.non.blanks<span class="p">)</span> <span class="o">&gt;</span> threshold
  blank.cols <span class="o">=</span> <span class="kp">which</span><span class="p">(</span>blank.cols <span class="o">==</span> <span class="bp">F</span><span class="p">)</span>
  
  <span class="kr">return</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>na.cols<span class="p">,</span> blank.cols<span class="p">)))</span>
<span class="p">}</span></code></pre></div>

<p>The indices of the unnecessary columns are </p>

<div class="highlight"><pre><code class="language-r" data-lang="r">no.use.col <span class="o">=</span> bad.cols<span class="p">(</span>train<span class="p">)</span>
no.use.col <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">7</span><span class="p">,</span> no.use.col<span class="p">)</span>
no.use.col</code></pre></div>

<div class="highlight"><pre><code class="language-text" data-lang="text">##   [1]   1   2   3   4   5   6   7  18  19  21  22  24  25  27  28  29  30
##  [18]  31  32  33  34  35  36  50  51  52  53  54  55  56  57  58  59  75
##  [35]  76  77  78  79  80  81  82  83  93  94  96  97  99 100 103 104 105
##  [52] 106 107 108 109 110 111 112 131 132 134 135 137 138 141 142 143 144
##  [69] 145 146 147 148 149 150  12  13  14  15  16  17  20  23  26  69  70
##  [86]  71  72  73  74  87  88  89  90  91  92  95  98 101 125 126 127 128
## [103] 129 130 133 136 139</code></pre></div>

<p>Now I prepare the data by separating out the classification column and removing the unnecessary columns. Since the classification column will not be used for analysis I remove it and keep track of it for later.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">train.class <span class="o">=</span> <span class="kp">as.factor</span><span class="p">(</span>train<span class="o">$</span>classe<span class="p">)</span>

train <span class="o">=</span> train<span class="p">[,</span> <span class="o">-</span>no.use.col<span class="p">]</span>
train<span class="o">$</span>classe <span class="o">=</span> <span class="kc">NULL</span></code></pre></div>

<p>I am
using PCA to reduce dimensionality. First have to center and rescale the data. The centering and scaling comes from the training data.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#calculate mean and standard deviations for each column of train</span>
means <span class="o">=</span> <span class="kp">colMeans</span><span class="p">(</span>train<span class="p">)</span>
sds <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>train<span class="p">,</span> <span class="m">2</span><span class="p">,</span> sd<span class="p">)</span>

<span class="c1">#center and rescale</span>
train <span class="o">=</span> <span class="kp">as.data.frame</span><span class="p">(</span><span class="kp">t</span><span class="p">((</span><span class="kp">t</span><span class="p">(</span>train<span class="p">)</span> <span class="o">-</span> means<span class="p">)</span><span class="o">/</span>sds<span class="p">))</span>

<span class="c1">#do PCA</span>
train.prcomp <span class="o">=</span> prcomp<span class="p">(</span>train<span class="p">,</span> center <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">#predict using PCA</span>
train <span class="o">=</span> <span class="kp">as.data.frame</span><span class="p">(</span>predict<span class="p">(</span>train.prcomp<span class="p">,</span> newdata <span class="o">=</span> train<span class="p">))</span></code></pre></div>

<p>A plot of the first two principal components of the training set. Do they separate 
the data well? I don’t really see good separation…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">qplot<span class="p">(</span>PC1<span class="p">,</span> PC2<span class="p">,</span> data <span class="o">=</span> train<span class="p">,</span> colour <span class="o">=</span> train.class<span class="p">)</span></code></pre></div>

<p><img src="/../figs/2014-10-30-Fit-Analysis/unnamed-chunk-7-1.png" alt="center" /> </p>

<p>Now use the random forest to predict. I split the data into train (80%) and validation (20%) pieces. I ran random forest on the train set, used the model to predict on the validation set and calculated the error between the predicted and actual values.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">train.cut <span class="o">=</span> train<span class="p">[,</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">25</span><span class="p">)]</span> <span class="c1">#use only a few of PCA&#39;s</span>

<span class="kp">set.seed</span><span class="p">(</span><span class="m">1224</span><span class="p">)</span>

<span class="c1">#split the data</span>
index <span class="o">=</span> <span class="kp">sample</span><span class="p">(</span><span class="kp">nrow</span><span class="p">(</span>train.cut<span class="p">),</span> size <span class="o">=</span> <span class="m">0.8</span><span class="o">*</span><span class="kp">nrow</span><span class="p">(</span>train.cut<span class="p">))</span>
X <span class="o">=</span> train.cut<span class="p">[</span>index<span class="p">,</span> <span class="p">]</span>
validation <span class="o">=</span> train.cut<span class="p">[</span><span class="o">-</span>index<span class="p">,]</span>

<span class="c1">#fit the model</span>
fit <span class="o">=</span> randomForest<span class="p">(</span>X<span class="p">,</span> train.class<span class="p">[</span>index<span class="p">],</span>
               importance <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> ntree <span class="o">=</span> <span class="m">130</span><span class="p">)</span>
predictions <span class="o">=</span> predict<span class="p">(</span>fit<span class="p">,</span> newdata <span class="o">=</span> validation<span class="p">)</span></code></pre></div>

<p>Table of predictions on validation set against actual values and calculated cross-tabulation of observed and predicted classed.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">predict.table <span class="o">=</span> <span class="kp">table</span><span class="p">(</span>predict <span class="o">=</span> predictions<span class="p">,</span> true <span class="o">=</span> train.class<span class="p">[</span><span class="o">-</span>index<span class="p">])</span>
confusionMatrix<span class="p">(</span>predict.table<span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-text" data-lang="text">## Confusion Matrix and Statistics
## 
##        true
## predict    A    B    C    D    E
##       A 1128   13    2    0    0
##       B    3  750    9    0    2
##       C    3    6  676   27    9
##       D    0    1    7  591    4
##       E    0    1    3    4  686
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9761          
##                  95% CI : (0.9708, 0.9806)
##     No Information Rate : 0.2889          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9696          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9947   0.9728   0.9699   0.9502   0.9786
## Specificity            0.9946   0.9956   0.9861   0.9964   0.9975
## Pos Pred Value         0.9869   0.9817   0.9376   0.9801   0.9885
## Neg Pred Value         0.9978   0.9934   0.9934   0.9907   0.9954
## Prevalence             0.2889   0.1964   0.1776   0.1585   0.1786
## Detection Rate         0.2874   0.1911   0.1722   0.1506   0.1748
## Detection Prevalence   0.2912   0.1946   0.1837   0.1536   0.1768
## Balanced Accuracy      0.9947   0.9842   0.9780   0.9733   0.9881</code></pre></div>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          



	<img src="http://localhost:4000/images/BenR2.jpg" class="bio-photo" alt="Ben Rifkind bio photo">

<h3>Ben Rifkind</h3>
<p>I recently completed my Ph.D in probability at the University of Toronto. Now I am messing around with R, python, and statistical analysis.</p>







<a href="http://github.com/benrifkind" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>








        </div>
        <p class="byline"><strong>Analysis of Bicep Curl Quality</strong> was published on <time datetime="2014-10-30T00:00:00-04:00">October 30, 2014</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://localhost:4000/Water-Usage-in-Toronto/" title="Water Usage in Toronto">Water Usage in Toronto</a></li>
    
      <li><a href="http://localhost:4000/Mapping-Stats-Canada-Data-with-R-part-2-of-3/" title="Mapping Stats Canada Data with R part 2 of 3">Mapping Stats Canada Data with R part 2 of 3</a></li>
    
      <li><a href="http://localhost:4000/Mapping-Stats-Canada-Data-with-R-part-1-of-3/" title="Mapping Stats Canada Data with R part 1 of 3">Mapping Stats Canada Data with R part 1 of 3</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    

<span>&copy; 2015 Ben Rifkind. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>

	        

</body>
</html>